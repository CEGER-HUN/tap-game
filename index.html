<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tap Mining Game</title>
<script src="https://cdn.jsdelivr.net/npm/phaser@3/dist/phaser.js"></script>
<style>
body { margin: 0; background: #000; }
canvas { display: block; margin: auto; }
</style>
</head>

<body>

<script>
const WORK_TIME = 10800000; // 3 saat (test i√ßin 10000 yapabilirsin)
const BG_SPEED = 1;

let game;
let working = false;
let startTime = 0;

const config = {
  type: Phaser.AUTO,
  width: 960,
  height: 540,
  scale: {
    mode: Phaser.Scale.FIT,
    autoCenter: Phaser.Scale.CENTER_BOTH
  },
  scene: {
    preload,
    create,
    update
  }
};

new Phaser.Game(config);

function preload() {
  // Backgrounds
  for (let i = 1; i <= 5; i++) {
    this.load.image("bg" + i, "./assets/bg" + i + ".png");
  }
  
  // Wagon frames
  this.load.image("w1", "./assets/wagon1.png");
  this.load.image("w2", "./assets/wagon2.png");
  this.load.image("w3", "./assets/wagon3.png");
  this.load.image("w4", "./assets/wagon4.png");
  this.load.image("w5", "./assets/wagon5.png");
}

let bg1, bg2;
let bgIndex = 1;

function create() {
  bg1 = this.add.tileSprite(0, 0, 960, 540, "bg1").setOrigin(0, 0);
  bg2 = this.add.tileSprite(960, 0, 960, 540, "bg2").setOrigin(0, 0);

  this.anims.create({
    key: "move",
    frames: [
      { key: "w1" },
      { key: "w2" },
      { key: "w3" },
      { key: "w4" },
      { key: "w5" }
    ],
    frameRate: 8,
    repeat: -1
  });

  this.wagon = this.add.sprite(480, 380, "w1");
  this.wagon.play("move");

  this.startText = this.add.text(480, 80, "START", {
    fontSize: "48px",
    color: "#00ff00",
    backgroundColor: "#000",
    padding: {x:20, y:10}
  }).setOrigin(0.5).setInteractive();

  this.startText.on("pointerdown", () => {
    if (!working) {
      startMining(this);
    } else {
      stopMining(this);
    }
  });
}

function update() {
  if (working) {
    bg1.tilePositionX += BG_SPEED;
    bg2.tilePositionX += BG_SPEED;

    if (Date.now() - startTime >= WORK_TIME) {
      stopMining(this);
    }
  }
}

function startMining(scene) {
  working = true;
  startTime = Date.now();
  scene.startText.setText("WORKING...");
}

function stopMining(scene) {
  working = false;
  scene.startText.setText("START");
}
</script>

</body>
</html>
