<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>GO Coin Game</title>
    <style>
        :root {
            --primary: #ffd700;
            --secondary: #a855f7;
            --accent: #ec4899;
            --text: #ffffff;
            --gold-gradient: linear-gradient(135deg, #ffd700 0%, #ffed4e 50%, #ffd700 100%);
            --purple-gradient: linear-gradient(135deg, #a855f7 0%, #ec4899 100%);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            background: radial-gradient(circle at center, #1a1a2e 0%, #0a0a0f 100%);
            color: var(--text);
            height: 100vh;
            display: flex;
            justify-content: center;
            overflow: hidden;
        }

        .game-container {
            width: 100%;
            max-width: 450px;
            height: 100%;
            background: rgba(26, 26, 46, 0.8);
            backdrop-filter: blur(20px);
            display: flex;
            flex-direction: column;
            padding: 14px 18px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            overflow: hidden;
        }

        header { 
            text-align: center; 
            flex-shrink: 0; 
            position: relative;
        }

        .menu-btn {
            position: absolute;
            left: 0;
            top: 10px;
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 10px;
            width: 45px;
            height: 45px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 5px;
            cursor: pointer;
            transition: 0.3s;
        }

        .menu-btn:active {
            background: rgba(255,255,255,0.2);
            transform: scale(0.95);
        }

        .menu-btn span {
            width: 24px;
            height: 3px;
            background: #fff;
            border-radius: 2px;
            transition: 0.3s;
        }

        .menu-btn:hover span {
            background: var(--primary);
        }

        #score {
            font-size: 2.8rem;
            font-weight: 900;
            color: var(--primary);
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
            line-height: 1.1;
        }

        .sub-label { font-size: 0.7rem; color: #888; text-transform: uppercase; letter-spacing: 2px; }

        .income-row {
            font-size: 0.75rem;
            color: #ffd700;
            margin-top: 3px;
            margin-bottom: 8px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }

        .income-row .icon-inline {
            width: 14px;
            height: 14px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .income-row .icon-inline svg {
            width: 100%;
            height: 100%;
            fill: currentColor;
        }

        .mini-bar {
            margin-top: 5px;
            padding: 6px 10px;
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
            border: 1px solid rgba(255,255,255,0.05);
        }

        .bar-track { 
            height: 14px;
            background: rgba(0,0,0,0.3); 
            border-radius: 10px; 
            overflow: hidden; 
        }
        .bar-fill { height:100%; border-radius:10px; width:0%; transition: width 0.3s; }
        .bar-fill.xp { background: linear-gradient(90deg, var(--secondary), var(--accent)); }
        .bar-fill.energy { background: linear-gradient(90deg, #00ff88, #00d9ff); width:100%; }

        .bar-label {
            display: flex;
            justify-content: space-between;
            font-size: 0.68rem;
            margin-bottom: 3px;
            font-weight: bold;
        }

        .bar-label .icon-inline {
            width: 16px;
            height: 16px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            margin-right: 4px;
        }

        .bar-label .icon-inline svg {
            width: 100%;
            height: 100%;
            fill: currentColor;
        }

        main {
            flex-shrink: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 8px 0 4px;
            position: relative;
        }

        .combo-container { width:120px; text-align:center; margin-bottom:4px; height:18px; }

        #combo-text { 
            font-size:0.78rem; 
            font-weight:900; 
            color:var(--accent); 
            opacity:0; 
            transition:opacity 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
        }

        #combo-text .icon-inline {
            width: 16px;
            height: 16px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        #combo-text .icon-inline svg {
            width: 100%;
            height: 100%;
            fill: currentColor;
        }

        .combo-bar { height:3px; background:rgba(0,0,0,0.3); border-radius:10px; overflow:hidden; margin-top:2px; }
        #combo-fill { height:100%; width:0%; background:var(--accent); box-shadow:0 0 6px var(--accent); transition:width 0.1s; }

        #coin-container { 
            position: relative; 
            cursor: pointer; 
            touch-action: manipulation;
            width: 280px;
            height: 280px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #main-coin {
            width: 200px;
            height: 200px;
            filter: drop-shadow(0 0 25px rgba(255,215,0,0.4));
            animation: float 3s infinite ease-in-out;
            position: relative;
            z-index: 3;
            user-select: none;
            -webkit-user-drag: none;
        }

        .collect-btn {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 240px;
            height: 240px;
            background: transparent;
            border: none;
            color: #fff;
            border-radius: 50%;
            font-size: 1rem;
            font-weight: 900;
            cursor: pointer;
            transition: transform 0.2s, filter 0.3s;
            z-index: 2;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 6px;
            text-shadow: 0 3px 10px rgba(0,0,0,0.9), 0 0 6px rgba(0,0,0,0.8);
            background-size: contain;
            background-position: center;
            background-repeat: no-repeat;
            opacity: 0;
            pointer-events: none;
        }

        .collect-btn.visible {
            opacity: 1;
            pointer-events: auto;
        }

        .collect-btn.has-coins {
            animation: collectPulse 2s infinite;
        }

        .collect-btn-amount {
            font-size: 1.5rem;
            font-weight: 900;
            color: #fff;
            text-shadow: 
                0 0 15px rgba(255, 215, 0, 1), 
                0 0 25px rgba(255, 215, 0, 0.8),
                0 3px 8px rgba(0,0,0,1),
                0 0 3px rgba(255, 255, 255, 0.5);
            filter: drop-shadow(0 0 10px rgba(255, 215, 0, 0.9));
        }

        .collect-btn-label {
            font-size: 0.85rem;
            font-weight: 900;
            color: #fff;
            opacity: 1;
            text-transform: uppercase;
            letter-spacing: 2px;
            text-shadow: 
                0 0 10px rgba(255, 215, 0, 0.9), 
                0 3px 6px rgba(0,0,0,1),
                0 0 3px rgba(255, 255, 255, 0.5);
        }

        .collect-btn.waiting {
            cursor: default;
            animation: none;
            opacity: 0;
        }

        .collect-btn.waiting .collect-btn-amount,
        .collect-btn.waiting .collect-btn-label {
            color: #888;
            text-shadow: 0 2px 4px rgba(0,0,0,0.6);
            filter: none;
        }

        .collect-btn:active:not(.waiting) { 
            transform: translate(-50%, -50%) scale(0.92); 
        }

        @keyframes collectPulse {
            0%, 100% { 
                filter: drop-shadow(0 0 20px rgba(255, 215, 0, 0.8));
                transform: translate(-50%, -50%) scale(1);
            }
            50% { 
                filter: drop-shadow(0 0 35px rgba(255, 215, 0, 1)) drop-shadow(0 0 50px rgba(255, 165, 0, 0.6));
                transform: translate(-50%, -50%) scale(1.08);
            }
        }

        #coin-container:active #main-coin { transform:scale(0.85) !important; animation:none; }
        .coin-disabled #main-coin { filter:grayscale(1) drop-shadow(0 0 8px rgba(100,100,100,0.3)); animation:none; }

        @keyframes float {
            0%,100% { transform:translateY(0); }
            50% { transform:translateY(-7px); }
        }

        .floating-text {
            position:fixed; color:var(--primary); font-weight:bold; font-size:1.2rem;
            pointer-events:none; animation:floatUp 0.8s forwards; z-index:1000;
            text-shadow:0 0 6px rgba(255,215,0,0.5);
        }
        @keyframes floatUp { from{opacity:1;transform:translateY(0)} to{opacity:0;transform:translateY(-90px)} }

        .bottom-nav {
            flex-shrink:0;
            margin-top: auto;
            padding-top: 10px;
        }

        .nav-buttons {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 6px;
            width: 100%;
        }

        .nav-btn {
            background: rgba(255,255,255,0.06);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 10px 6px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 3px;
            cursor: pointer;
            transition: 0.15s;
            position: relative;
        }

        .nav-btn:active {
            transform: scale(0.95);
            background: rgba(255,255,255,0.1);
        }

        .nav-btn-icon {
            font-size: 1.3rem;
            line-height: 1;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .nav-btn-icon svg {
            width: 100%;
            height: 100%;
            fill: currentColor;
        }

        .nav-btn-label {
            font-size: 0.6rem;
            font-weight: 700;
            color: #aaa;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .nav-btn-badge {
            position: absolute;
            top: 4px;
            right: 4px;
            background: var(--secondary);
            color: white;
            font-size: 0.55rem;
            font-weight: 800;
            padding: 2px 4px;
            border-radius: 8px;
            min-width: 14px;
            text-align: center;
        }

        .sheet-overlay {
            position:fixed; inset:0;
            background:rgba(0,0,0,0.55);
            z-index:500;
            opacity:0; pointer-events:none;
            transition: opacity 0.25s;
        }
        .sheet-overlay.open { opacity:1; pointer-events:auto; }

        .sheet {
            position:fixed;
            bottom:0; left:50%; transform:translateX(-50%) translateY(100%);
            width:100%; max-width:450px;
            background: #12121f;
            border-radius: 22px 22px 0 0;
            border-top: 1px solid rgba(255,255,255,0.1);
            height: 75vh;
            display:flex; flex-direction:column;
            z-index:501;
            transition: transform 0.3s cubic-bezier(0.32,0.72,0,1);
            overflow:hidden;
        }
        .sheet.open { transform:translateX(-50%) translateY(0); }

        .sheet-handle {
            width:40px; height:4px; background:rgba(255,255,255,0.2);
            border-radius:3px; margin:10px auto 0;
            flex-shrink:0;
        }

        .sheet-header {
            display:flex; align-items:center; justify-content:space-between;
            padding: 12px 18px 8px;
            flex-shrink:0;
        }
        .sheet-title { font-size:1.05rem; font-weight:800; color:#fff; display: flex; align-items: center; gap: 8px; }
        .sheet-close {
            background:rgba(255,255,255,0.08); border:none; color:#aaa;
            width:28px; height:28px; border-radius:50%;
            font-size:1rem; cursor:pointer; display:flex;
            align-items:center; justify-content:center;
        }
        .sheet-close:active { background:rgba(255,255,255,0.15); }

        .sheet-content {
            flex: 1;
            overflow-y: auto;
            padding: 0 18px 24px;
        }
        .sheet-content::-webkit-scrollbar { width:3px; }
        .sheet-content::-webkit-scrollbar-thumb { background:rgba(168,85,247,0.4); border-radius:10px; }

        .cat-tabs {
            display:flex; gap:6px; padding:0 18px;
            flex-shrink:0; margin-bottom:10px;
            overflow-x:auto; -webkit-overflow-scrolling:touch;
        }
        .cat-tabs::-webkit-scrollbar { display:none; }

        .cat-tab {
            flex-shrink:0;
            background:rgba(255,255,255,0.06); border:1px solid rgba(255,255,255,0.1);
            color:#777; padding:7px 14px; border-radius:20px; font-size:0.72rem;
            font-weight:700; cursor:pointer; white-space:nowrap;
            transition:0.2s; display:flex; align-items:center; gap:5px;
        }
        .cat-tab .tab-icon { 
            width:16px; height:16px; display:flex; align-items:center; justify-content:center; 
        }
        .cat-tab .tab-icon svg {
            width: 100%;
            height: 100%;
            fill: currentColor;
        }
        .cat-tab.active {
            background:var(--secondary); border-color:var(--secondary); color:white;
        }

        .cards-scroll {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
        }

        .card {
            background:rgba(255,255,255,0.06); 
            border:1px solid rgba(255,255,255,0.1);
            border-radius:14px; 
            padding:12px;
            display:flex;
            flex-direction: column;
            align-items:center;
            text-align: center;
            cursor:pointer; 
            transition:0.15s;
            min-height: 140px;
            justify-content: space-between;
        }
        .card:active { transform:scale(0.95); }
        .card.can-buy { 
            border-color:rgba(168,85,247,0.5); 
            background:rgba(168,85,247,0.08);
            box-shadow: 0 0 15px rgba(168,85,247,0.2);
        }
        .card.locked { opacity:0.3; cursor:not-allowed; }
        .card.locked:active { transform:none; }
        .card.cant-afford { opacity:0.5; cursor:not-allowed; }
        .card.cant-afford:active { transform:none; }

        .card-top {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
            flex: 1;
        }

        .card-icon { 
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 4px;
        }
        .card-icon svg {
            width: 100%;
            height: 100%;
        }
        .card-name { 
            font-size:0.85rem; 
            font-weight:700; 
            color:#fff; 
            letter-spacing:0.2px;
            line-height: 1.2;
        }
        .card-earn { 
            font-size:0.68rem; 
            color:#00ff88; 
            font-weight:600;
            margin-top: 2px;
        }

        .card-bottom {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            width: 100%;
        }

        .card-price {
            background:var(--secondary); 
            color:white; 
            border-radius:8px;
            padding:6px 12px; 
            font-weight:700; 
            font-size:0.75rem;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
        }
        .card-price .icon-inline {
            width: 12px;
            height: 12px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        .card-price .icon-inline svg {
            width: 100%;
            height: 100%;
            fill: currentColor;
        }
        .card.cant-afford .card-price { background:#444; }
        .card.locked .card-price { background:#333; color:#555; }

        .card-lvl { 
            font-size:0.64rem; 
            color:#666; 
            font-weight:600;
        }

        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #666;
        }
        .empty-state-icon {
            width: 60px;
            height: 60px;
            margin: 0 auto 12px;
            opacity: 0.5;
        }
        .empty-state-icon svg {
            width: 100%;
            height: 100%;
        }
        .empty-state-text {
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .popup-overlay {
            position:fixed; inset:0; background:rgba(0,0,0,0.6);
            display:flex; justify-content:center; align-items:center;
            z-index:999; animation:fadeIn 0.2s;
        }
        .popup-box {
            background:linear-gradient(135deg,#1a1a2e,#2d1b69); border:2px solid var(--secondary);
            border-radius:18px; padding:24px 28px; text-align:center;
            animation:popIn 0.25s cubic-bezier(0.175,0.885,0.32,1.275); max-width:280px; width:90%;
        }
        .popup-box .pop-icon { 
            width: 80px;
            height: 80px;
            margin: 0 auto 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .popup-box .pop-icon svg {
            width: 100%;
            height: 100%;
        }
        .popup-box h2 { color:var(--primary); font-size:1.4rem; margin-bottom:4px; }
        .popup-box p { color:#aaa; font-size:0.76rem; margin-bottom:14px; }
        .popup-box button {
            background:var(--secondary); border:none; color:white;
            padding:8px 24px; border-radius:9px; font-size:0.82rem; font-weight:bold; cursor:pointer;
        }
        @keyframes fadeIn { from{opacity:0} to{opacity:1} }
        @keyframes popIn { from{transform:scale(0.5);opacity:0} to{transform:scale(1);opacity:1} }

        /* Yan Menü */
        .drawer-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.6);
            z-index: 600;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }

        .drawer-overlay.open {
            opacity: 1;
            pointer-events: auto;
        }

        .drawer {
            position: fixed;
            left: 0;
            top: 0;
            bottom: 0;
            width: 280px;
            max-width: 80%;
            background: #12121f;
            z-index: 601;
            transform: translateX(-100%);
            transition: transform 0.3s ease;
            display: flex;
            flex-direction: column;
            border-right: 1px solid rgba(255,255,255,0.1);
        }

        .drawer.open {
            transform: translateX(0);
        }

        .drawer-header {
            padding: 20px;
            background: rgba(255,215,0,0.1);
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .drawer-header h2 {
            color: var(--primary);
            font-size: 1.3rem;
            margin-bottom: 5px;
        }

        .drawer-header p {
            color: #888;
            font-size: 0.85rem;
        }

        .drawer-content {
            flex: 1;
            overflow-y: auto;
            padding: 10px;
        }

        .drawer-item {
            padding: 15px;
            display: flex;
            align-items: center;
            gap: 15px;
            color: #fff;
            text-decoration: none;
            border-radius: 10px;
            transition: 0.2s;
            margin-bottom: 5px;
            cursor: pointer;
        }

        .drawer-item:hover {
            background: rgba(255,255,255,0.1);
        }

        .drawer-item:active {
            transform: scale(0.98);
        }

        .drawer-item-icon {
            font-size: 1.5rem;
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .drawer-item-icon svg {
            width: 100%;
            height: 100%;
        }

        .drawer-item-text {
            flex: 1;
        }

        .drawer-item-title {
            font-size: 1rem;
            font-weight: 600;
            color: #fff;
        }

        .drawer-item-desc {
            font-size: 0.75rem;
            color: #888;
            margin-top: 2px;
        }

        .drawer-divider {
            height: 1px;
            background: rgba(255,255,255,0.1);
            margin: 10px 0;
        }

        /* Profil Sayfası */
        .profile-hero {
            text-align: center;
            padding: 20px;
            background: linear-gradient(135deg, rgba(168,85,247,0.2), rgba(236,72,153,0.2));
            border-radius: 15px;
            margin-bottom: 15px;
        }

        .avatar-container {
            width: 100px;
            height: 100px;
            margin: 0 auto 15px;
            border-radius: 50%;
            border: 4px solid var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255,255,255,0.1);
            cursor: pointer;
            transition: 0.3s;
            overflow: hidden;
        }

        .avatar-container svg {
            width: 60%;
            height: 60%;
        }

        .avatar-container:active {
            transform: scale(0.95);
        }

        .profile-name {
            font-size: 1.5rem;
            font-weight: bold;
            color: #fff;
            margin-bottom: 5px;
        }

        .profile-id {
            font-size: 0.85rem;
            color: #888;
        }

        .edit-name-btn {
            background: var(--secondary);
            border: none;
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 0.85rem;
            margin-top: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            margin-left: auto;
            margin-right: auto;
        }

        .edit-name-btn svg {
            width: 14px;
            height: 14px;
            fill: currentColor;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 15px;
        }

        .stat-box {
            background: rgba(255,255,255,0.05);
            padding: 15px;
            border-radius: 12px;
            text-align: center;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary);
        }

        .stat-label {
            font-size: 0.75rem;
            color: #888;
            margin-top: 5px;
        }

        .achievements-section {
            margin-top: 20px;
        }

        .section-title {
            font-size: 1.1rem;
            font-weight: bold;
            color: #fff;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .section-title svg {
            width: 20px;
            height: 20px;
        }

        .achievement-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }

        .achievement {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 15px 10px;
            text-align: center;
            transition: 0.2s;
        }

        .achievement.unlocked {
            background: rgba(168,85,247,0.1);
            border-color: var(--secondary);
        }

        .achievement.locked {
            opacity: 0.4;
        }

        .achievement-icon {
            width: 50px;
            height: 50px;
            margin: 0 auto 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .achievement-icon svg {
            width: 100%;
            height: 100%;
        }

        .achievement-name {
            font-size: 0.7rem;
            color: #fff;
            font-weight: 600;
        }

        .achievement-desc {
            font-size: 0.65rem;
            color: #888;
            margin-top: 3px;
        }

        /* Spin Wheel */
        .wheel-container {
            padding: 20px;
            text-align: center;
        }

        .wheel-wrapper {
            position: relative;
            width: 300px;
            height: 300px;
            margin: 20px auto;
        }

        .wheel {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 8px solid var(--primary);
            position: relative;
            transition: transform 4s cubic-bezier(0.17, 0.67, 0.12, 0.99);
            background: conic-gradient(
                from 0deg,
                #ff6b6b 0deg 45deg,
                #4ecdc4 45deg 90deg,
                #ffe66d 90deg 135deg,
                #a8e6cf 135deg 180deg,
                #ff8b94 180deg 225deg,
                #c7ceea 225deg 270deg,
                #ffd3b6 270deg 315deg,
                #ffaaa5 315deg 360deg
            );
            box-shadow: 0 0 30px rgba(255,215,0,0.5);
        }

        .wheel-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 60px;
            height: 60px;
            background: var(--primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 20px rgba(255,215,0,0.8);
            z-index: 10;
        }

        .wheel-center svg {
            width: 30px;
            height: 30px;
        }

        .wheel-pointer {
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-top: 30px solid #ff4444;
            z-index: 11;
            filter: drop-shadow(0 3px 5px rgba(0,0,0,0.3));
        }

        .spin-btn {
            background: linear-gradient(135deg, var(--primary), #ffed4e);
            color: #1a1a2e;
            border: none;
            padding: 15px 40px;
            border-radius: 30px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            margin-top: 20px;
            transition: 0.3s;
            box-shadow: 0 5px 15px rgba(255,215,0,0.3);
        }

        .spin-btn:active {
            transform: scale(0.95);
        }

        .spin-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .spin-info {
            margin-top: 15px;
            color: #888;
            font-size: 0.85rem;
        }

        .spin-timer {
            color: var(--primary);
            font-weight: bold;
        }

        /* Avatar Seçici */
        .avatar-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin: 20px 0;
        }

        .avatar-option {
            width: 60px;
            height: 60px;
            padding: 15px;
            background: rgba(255,255,255,0.05);
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 15px;
            cursor: pointer;
            transition: 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .avatar-option svg {
            width: 100%;
            height: 100%;
        }

        .avatar-option:active {
            transform: scale(0.9);
        }

        .avatar-option.selected {
            border-color: var(--primary);
            background: rgba(255,215,0,0.1);
        }

        /* Enerji ve Combo icon'ları için */
        .energy-icon {
            width: 20px;
            height: 20px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            vertical-align: middle;
            margin-right: 5px;
        }

        .energy-icon svg {
            width: 100%;
            height: 100%;
        }

        .locked-icon {
            width: 40px;
            height: 40px;
            opacity: 0.5;
        }

        .locked-icon svg {
            width: 100%;
            height: 100%;
        }

        /* Ana Coin SVG Stil */
        .main-coin-svg {
            width: 100%;
            height: 100%;
            filter: drop-shadow(0 0 20px rgba(255,215,0,0.5));
        }
    </style>
</head>
<body>
<div class="game-container">

    <header>
        <button class="menu-btn" id="menu-btn">
            <span></span>
            <span></span>
            <span></span>
        </button>
        <h1 id="score">0</h1>
        <p class="sub-label">Coins</p>
        <div class="income-row">
            <span class="icon-inline">
                <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1.41 16.09V20h-2.67v-1.93c-1.71-.36-3.16-1.46-3.27-3.4h1.96c.1 1.05.82 1.87 2.65 1.87 1.96 0 2.4-.98 2.4-1.59 0-.83-.44-1.61-2.67-2.14-2.48-.6-4.18-1.62-4.18-3.67 0-1.72 1.39-2.84 3.11-3.21V4h2.67v1.95c1.86.45 2.79 1.86 2.85 3.39H14.3c-.05-1.11-.64-1.87-2.22-1.87-1.5 0-2.4.68-2.4 1.64 0 .84.65 1.39 2.67 1.91s4.18 1.39 4.18 3.91c-.01 1.83-1.38 2.83-3.12 3.16z"/></svg>
            </span>
            Saatlik: <span id="hourly-income">0</span> &nbsp;|&nbsp; 3h: <span id="pending-income">0</span>
        </div>

        <div class="mini-bar">
            <div class="bar-label">
                <span>
                    <span class="icon-inline">
                        <svg viewBox="0 0 24 24"><path d="M5 16c0 3.87 3.13 7 7 7s7-3.13 7-7v-4H5v4zM16.12 4.37l2.1-2.1-.82-.83-2.3 2.31C14.16 3.28 13.12 3 12 3s-2.16.28-3.09.75L6.6 1.44l-.82.83 2.1 2.1C6.14 5.64 5 7.68 5 10v1h14v-1c0-2.32-1.14-4.36-2.88-5.63zM9 9c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm6 0c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1z"/></svg>
                    </span>
                    Level <span id="level-val">1</span>
                </span>
                <span id="xp-text">0 / 100 XP</span>
            </div>
            <div class="bar-track"><div class="bar-fill xp" id="xp-fill"></div></div>
        </div>

        <div class="mini-bar">
            <div class="bar-label">
                <span>
                    <span class="icon-inline">
                        <svg viewBox="0 0 24 24"><path d="M11 21h-1l1-7H7.5c-.58 0-.57-.32-.38-.66.19-.34.05-.08.07-.12C8.48 10.94 10.42 7.54 13 3h1l-1 7h3.5c.49 0 .56.33.47.51l-.07.15C12.96 17.55 11 21 11 21z"/></svg>
                    </span>
                    Enerji
                </span>
                <span id="energy-text">1000 / 1000</span>
            </div>
            <div class="bar-track"><div class="bar-fill energy" id="energy-fill"></div></div>
        </div>
    </header>

    <main>
        <div class="combo-container">
            <div id="combo-text">
                <span class="icon-inline">
                    <svg viewBox="0 0 24 24"><path d="M13.5.67s.74 2.65.74 4.8c0 2.06-1.35 3.73-3.41 3.73-2.07 0-3.63-1.67-3.63-3.73l.03-.36C5.21 7.51 4 10.62 4 14c0 4.42 3.58 8 8 8s8-3.58 8-8C20 8.61 17.41 3.8 13.5.67zM11.71 19c-1.78 0-3.22-1.4-3.22-3.14 0-1.62 1.05-2.76 2.81-3.12 1.77-.36 3.6-1.21 4.62-2.58.39 1.29.59 2.65.59 4.04 0 2.65-2.15 4.8-4.8 4.8z"/></svg>
                </span>
                COMBO X1
            </div>
            <div class="combo-bar"><div id="combo-fill"></div></div>
        </div>
        <div id="coin-container">
            <button class="collect-btn" id="collect-btn">
                <div class="collect-btn-amount" id="collect-amount">
                    <span class="icon-inline" style="width:24px;height:24px;">
                        <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1.41 16.09V20h-2.67v-1.93c-1.71-.36-3.16-1.46-3.27-3.4h1.96c.1 1.05.82 1.87 2.65 1.87 1.96 0 2.4-.98 2.4-1.59 0-.83-.44-1.61-2.67-2.14-2.48-.6-4.18-1.62-4.18-3.67 0-1.72 1.39-2.84 3.11-3.21V4h2.67v1.95c1.86.45 2.79 1.86 2.85 3.39H14.3c-.05-1.11-.64-1.87-2.22-1.87-1.5 0-2.4.68-2.4 1.64 0 .84.65 1.39 2.67 1.91s4.18 1.39 4.18 3.91c-.01 1.83-1.38 2.83-3.12 3.16z"/></svg>
                    </span>
                </div>
                <div class="collect-btn-label" id="collect-label">Bekle</div>
            </button>
            <img id="main-coin" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 200 200'%3E%3Cdefs%3E%3ClinearGradient id='gold' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' style='stop-color:%23ffd700'/%3E%3Cstop offset='50%25' style='stop-color:%23ffed4e'/%3E%3Cstop offset='100%25' style='stop-color:%23ffd700'/%3E%3C/linearGradient%3E%3ClinearGradient id='goldDark' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' style='stop-color:%23b8860b'/%3E%3Cstop offset='100%25' style='stop-color:%23daa520'/%3E%3C/linearGradient%3E%3Cfilter id='glow'%3E%3CfeGaussianBlur stdDeviation='3' result='coloredBlur'/%3E%3CfeMerge%3E%3CfeMergeNode in='coloredBlur'/%3E%3CfeMergeNode in='SourceGraphic'/%3E%3C/feMerge%3E%3C/filter%3E%3C/defs%3E%3Ccircle cx='100' cy='100' r='90' fill='url(%23goldDark)'/%3E%3Ccircle cx='100' cy='100' r='80' fill='url(%23gold)' filter='url(%23glow)'/%3E%3Ccircle cx='100' cy='100' r='70' fill='none' stroke='%23fff' stroke-width='2' opacity='0.5'/%3E%3Ctext x='100' y='115' font-size='60' text-anchor='middle' fill='%23b8860b' font-weight='bold' font-family='Arial'%3EGO%3C/text%3E%3Ccircle cx='100' cy='100' r='90' fill='none' stroke='%23ffd700' stroke-width='4' opacity='0.8'/%3E%3C/svg%3E" alt="GO Coin">
        </div>
    </main>

    <div class="bottom-nav">
        <div class="nav-buttons">
            <div class="nav-btn" id="btn-kartlar">
                <span class="nav-btn-badge" id="kartlar-badge">0</span>
                <span class="nav-btn-icon">
                    <svg viewBox="0 0 24 24"><path d="M20 4H4v2h16V4zm1 10v-2l-1-5H4l-1 5v2h1v6h10v-6h4v6h2v-6h1zm-9 4H6v-4h6v4z"/></svg>
                </span>
                <span class="nav-btn-label">Kartlar</span>
            </div>
            <div class="nav-btn" id="btn-spin">
                <span class="nav-btn-icon">
                    <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v6h-2zm0 8h2v2h-2z"/></svg>
                </span>
                <span class="nav-btn-label">Çarkıfelek</span>
            </div>
            <div class="nav-btn" id="btn-profil">
                <span class="nav-btn-icon">
                    <svg viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
                </span>
                <span class="nav-btn-label">Profil</span>
            </div>
            <div class="nav-btn" id="btn-cuzdan">
                <span class="nav-btn-icon">
                    <svg viewBox="0 0 24 24"><path d="M21 18v1c0 1.1-.9 2-2 2H5c-1.11 0-2-.9-2-2V5c0-1.1.89-2 2-2h14c1.1 0 2 .9 2 2v1h-9c-1.11 0-2 .9-2 2v8c0 1.1.89 2 2 2h9zm-9-2h10V8H12v8zm4-2.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"/></svg>
                </span>
                <span class="nav-btn-label">Cüzdan</span>
            </div>
            <div class="nav-btn" id="btn-roadmap">
                <span class="nav-btn-icon">
                    <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/></svg>
                </span>
                <span class="nav-btn-label">Takas</span>
            </div>
        </div>
    </div>

    <div class="sheet-overlay" id="sheet-overlay"></div>

    <!-- Kartlar Sheet -->
    <div class="sheet" id="sheet-kartlar">
        <div class="sheet-handle"></div>
        <div class="sheet-header">
            <span class="sheet-title">
                <span class="icon-inline" style="width:20px;height:20px;">
                    <svg viewBox="0 0 24 24"><path d="M20 4H4v2h16V4zm1 10v-2l-1-5H4l-1 5v2h1v6h10v-6h4v6h2v-6h1zm-9 4H6v-4h6v4z"/></svg>
                </span>
                Kartlar
            </span>
            <button class="sheet-close" onclick="closeAllSheets()">
                <svg width="16" height="16" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" fill="currentColor"/></svg>
            </button>
        </div>
        <div class="cat-tabs" id="cat-tabs"></div>
        <div class="sheet-content">
            <div class="cards-scroll" id="cards-scroll"></div>
        </div>
    </div>

    <!-- Profil Sheet -->
    <div class="sheet" id="sheet-profil">
        <div class="sheet-handle"></div>
        <div class="sheet-header">
            <span class="sheet-title">
                <span class="icon-inline" style="width:20px;height:20px;">
                    <svg viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
                </span>
                Profil
            </span>
            <button class="sheet-close" onclick="closeAllSheets()">
                <svg width="16" height="16" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" fill="currentColor"/></svg>
            </button>
        </div>
        <div class="sheet-content" id="profile-content">
            <div class="profile-hero">
                <div class="avatar-container" id="avatar-display" onclick="openAvatarSelector()">
                    <svg viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" fill="currentColor"/></svg>
                </div>
                <div class="profile-name" id="profile-name">Oyuncu</div>
                <div class="profile-id">ID: #12345</div>
                <button class="edit-name-btn" onclick="editName()">
                    <svg viewBox="0 0 24 24"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/></svg>
                    İsmi Düzenle
                </button>
            </div>

            <div class="stats-grid">
                <div class="stat-box">
                    <div class="stat-value" id="stat-coins">0</div>
                    <div class="stat-label">Toplam Coin</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="stat-level">1</div>
                    <div class="stat-label">Level</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="stat-clicks">0</div>
                    <div class="stat-label">Toplam Tıklama</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="stat-cards">0</div>
                    <div class="stat-label">Satın Alınan Kart</div>
                </div>
            </div>

            <div class="achievements-section">
                <div class="section-title">
                    <svg viewBox="0 0 24 24"><path d="M19 5h-2V3H7v2H5c-1.1 0-2 .9-2 2v1c0 2.55 1.92 4.63 4.39 4.94.63 1.5 1.98 2.63 3.61 2.96V19H7v2h10v-2h-4v-3.1c1.63-.33 2.98-1.46 3.61-2.96C19.08 12.63 21 10.55 21 8V7c0-1.1-.9-2-2-2zM5 8V7h2v3.82C5.84 10.4 5 9.3 5 8zm14 0c0 1.3-.84 2.4-2 2.82V7h2v1z"/></svg>
                    Başarımlar
                </div>
                <div class="achievement-grid" id="achievements-grid"></div>
            </div>
        </div>
    </div>

    <!-- Spin Wheel Sheet -->
    <div class="sheet" id="sheet-spin">
        <div class="sheet-handle"></div>
        <div class="sheet-header">
            <span class="sheet-title">
                <span class="icon-inline" style="width:20px;height:20px;">
                    <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v6h-2zm0 8h2v2h-2z"/></svg>
                </span>
                Çarkıfelek
            </span>
            <button class="sheet-close" onclick="closeAllSheets()">
                <svg width="16" height="16" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" fill="currentColor"/></svg>
            </button>
        </div>
        <div class="sheet-content">
            <div class="wheel-container">
                <h3 style="color: var(--primary); margin-bottom: 10px;">Şansını Dene!</h3>
                <div class="wheel-wrapper">
                    <div class="wheel-pointer"></div>
                    <div class="wheel" id="wheel">
                        <div class="wheel-center">
                            <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v6h-2zm0 8h2v2h-2z"/></svg>
                        </div>
                    </div>
                </div>
                <button class="spin-btn" id="spin-btn" onclick="spinWheel()">ÇEVİR!</button>
                <div class="spin-info">
                    <div>Kalan Spin: <span class="spin-timer" id="spin-count">3</span></div>
                    <div id="spin-timer-text"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Cüzdan Sheet -->
    <div class="sheet" id="sheet-cuzdan">
        <div class="sheet-handle"></div>
        <div class="sheet-header">
            <span class="sheet-title">
                <span class="icon-inline" style="width:20px;height:20px;">
                    <svg viewBox="0 0 24 24"><path d="M21 18v1c0 1.1-.9 2-2 2H5c-1.11 0-2-.9-2-2V5c0-1.1.89-2 2-2h14c1.1 0 2 .9 2 2v1h-9c-1.11 0-2 .9-2 2v8c0 1.1.89 2 2 2h9zm-9-2h10V8H12v8zm4-2.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"/></svg>
                </span>
                Cüzdan
            </span>
            <button class="sheet-close" onclick="closeAllSheets()">
                <svg width="16" height="16" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" fill="currentColor"/></svg>
            </button>
        </div>
        <div class="sheet-content">
            <div class="empty-state">
                <div class="empty-state-icon">
                    <svg viewBox="0 0 24 24"><path d="M21 18v1c0 1.1-.9 2-2 2H5c-1.11 0-2-.9-2-2V5c0-1.1.89-2 2-2h14c1.1 0 2 .9 2 2v1h-9c-1.11 0-2 .9-2 2v8c0 1.1.89 2 2 2h9zm-9-2h10V8H12v8zm4-2.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"/></svg>
                </div>
                <div class="empty-state-text">Cüzdan özellikleri yakında eklenecek!</div>
            </div>
        </div>
    </div>

    <!-- Takas Sheet -->
    <div class="sheet" id="sheet-roadmap">
        <div class="sheet-handle"></div>
        <div class="sheet-header">
            <span class="sheet-title">
                <span class="icon-inline" style="width:20px;height:20px;">
                    <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/></svg>
                </span>
                Takas
            </span>
            <button class="sheet-close" onclick="closeAllSheets()">
                <svg width="16" height="16" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" fill="currentColor"/></svg>
            </button>
        </div>
        <div class="sheet-content">
            <div class="empty-state">
                <div class="empty-state-icon">
                    <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/></svg>
                </div>
                <div class="empty-state-text">Takas özellikleri yakında eklenecek!</div>
            </div>
        </div>
    </div>

</div>

<script>
(function(){

    const CATEGORIES = [
        { id:'profesyoneller', name:'Profesyon', icon:'briefcase' },
        { id:'sirketler',      name:'Şirketler', icon:'building' },
        { id:'teknoloji',      name:'Teknoloji', icon:'laptop' },
        { id:'yukseltmeler',   name:'2x Boost', icon:'zap' }
    ];

    const CARDS = [
        { id:'freelancer',  cat:'profesyoneller', name:'Freelancer',        icon:'laptop', baseCost:100,    baseEarn:50,    unlock:null },
        { id:'danisman',    cat:'profesyoneller', name:'Danışman',          icon:'briefcase',  baseCost:500,    baseEarn:200,   unlock:{card:'freelancer', level:3} },
        { id:'muhasebeci',  cat:'profesyoneller', name:'Muhasebeci',        icon:'calculator',  baseCost:2000,   baseEarn:600,   unlock:{card:'danisman',   level:3} },
        { id:'avukat',      cat:'profesyoneller', name:'Avukat',            icon:'scale',  baseCost:8000,   baseEarn:1500,  unlock:{card:'muhasebeci', level:3} },
        { id:'ceo',         cat:'profesyoneller', name:'CEO',               icon:'crown',  baseCost:35000,  baseEarn:4000,  unlock:{card:'avukat',     level:3} },
        { id:'cafe',        cat:'sirketler', name:'Cafe',              icon:'coffee',  baseCost:200,    baseEarn:80,    unlock:null },
        { id:'restoran',    cat:'sirketler', name:'Restoran',          icon:'utensils', baseCost:1200,   baseEarn:350,   unlock:{card:'cafe',      level:3} },
        { id:'butik',       cat:'sirketler', name:'Boutique',          icon:'shopping-bag',  baseCost:5000,   baseEarn:900,   unlock:{card:'restoran',  level:3} },
        { id:'otel',        cat:'sirketler', name:'Otel',              icon:'hotel',  baseCost:22000,  baseEarn:2500,  unlock:{card:'butik',     level:3} },
        { id:'alisveris',   cat:'sirketler', name:'Alışveriş Merkezi', icon:'shopping-cart',  baseCost:100000, baseEarn:8000,  unlock:{card:'otel',      level:3} },
        { id:'app',         cat:'teknoloji', name:'App Geliştirme',    icon:'smartphone',  baseCost:300,    baseEarn:100,   unlock:null },
        { id:'saas',        cat:'teknoloji', name:'SaaS Platforma',    icon:'cloud',  baseCost:1800,   baseEarn:450,   unlock:{card:'app',    level:3} },
        { id:'kripto',      cat:'teknoloji', name:'Kripto Madencilik', icon:'pickaxe',  baseCost:7000,   baseEarn:1200,  unlock:{card:'saas',   level:3} },
        { id:'ai',          cat:'teknoloji', name:'AI Startup',        icon:'bot',  baseCost:30000,  baseEarn:3500,  unlock:{card:'kripto', level:3} },
        { id:'uzay',        cat:'teknoloji', name:'Uzay Teknoloji',    icon:'rocket',  baseCost:150000, baseEarn:12000, unlock:{card:'ai',     level:3} },
        { id:'clickpower',  cat:'yukseltmeler', name:'Tıklama Gücü', icon:'zap', baseCost:50, baseEarn:0, unlock:null, isUpgrade:true }
    ];

    const ACHIEVEMENTS = [
        { id:'first_coin', name:'İlk Coin', desc:'İlk coini kazan', icon:'coin', requirement:1, check:(gs)=>gs.score>=1 },
        { id:'coin_1k', name:'1K Coin', desc:'1000 coin kazan', icon:'coins', requirement:1000, check:(gs)=>gs.score>=1000 },
        { id:'coin_10k', name:'10K Coin', desc:'10000 coin kazan', icon:'gem', requirement:10000, check:(gs)=>gs.score>=10000 },
        { id:'level_5', name:'Level 5', desc:'Level 5\'e ulaş', icon:'star', requirement:5, check:(gs)=>gs.level>=5 },
        { id:'level_10', name:'Level 10', desc:'Level 10\'a ulaş', icon:'trophy', requirement:10, check:(gs)=>gs.level>=10 },
        { id:'first_card', name:'İlk Kart', desc:'İlk kartı al', icon:'store', requirement:1, check:(gs)=>gs.totalClicks>=1 },
        { id:'clicks_100', name:'100 Tıklama', desc:'100 kez tıkla', icon:'mouse', requirement:100, check:(gs)=>gs.totalClicks>=100 },
        { id:'clicks_1000', name:'1K Tıklama', desc:'1000 kez tıkla', icon:'mouse-pointer', requirement:1000, check:(gs)=>gs.totalClicks>=1000 },
        { id:'combo_10', name:'Combo Master', desc:'X10 combo yap', icon:'flame', requirement:10, check:(gs)=>gs.maxCombo>=10 }
    ];

    const AVATARS = ['user', 'wallet', 'spin', 'globe', 'zap', 'flame', 'coin', 'settings'];

    const WHEEL_PRIZES = [
        { label:'100', value:100, color:'#ff6b6b' },
        { label:'500', value:500, color:'#4ecdc4' },
        { label:'1K', value:1000, color:'#ffe66d' },
        { label:'50', value:50, color:'#a8e6cf' },
        { label:'250', value:250, color:'#ff8b94' },
        { label:'2K', value:2000, color:'#c7ceea' },
        { label:'75', value:75, color:'#ffd3b6' },
        { label:'5K', value:5000, color:'#ffaaa5' }
    ];

    // SVG Icon Helpers
    const ICONS = {
        coin: '<svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1.41 16.09V20h-2.67v-1.93c-1.71-.36-3.16-1.46-3.27-3.4h1.96c.1 1.05.82 1.87 2.65 1.87 1.96 0 2.4-.98 2.4-1.59 0-.83-.44-1.61-2.67-2.14-2.48-.6-4.18-1.62-4.18-3.67 0-1.72 1.39-2.84 3.11-3.21V4h2.67v1.95c1.86.45 2.79 1.86 2.85 3.39H14.3c-.05-1.11-.64-1.87-2.22-1.87-1.5 0-2.4.68-2.4 1.64 0 .84.65 1.39 2.67 1.91s4.18 1.39 4.18 3.91c-.01 1.83-1.38 2.83-3.12 3.16z"/></svg>',
        coins: '<svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/><path d="M12.31 11.14c-1.99-.22-3.28-.92-3.28-1.74 0-.84.79-1.37 2.08-1.37 1.18 0 1.97.53 2.25 1.31h1.75c-.27-1.46-1.45-2.57-3.37-2.83V4h-1.5v2.51c-1.81.31-3.16 1.41-3.16 2.96 0 1.91 1.68 2.67 4.01 2.97 2.25.28 3.28.99 3.28 1.87 0 .62-.48 1.36-2.08 1.36-1.42 0-2.36-.6-2.66-1.5H7.48c.32 1.64 1.59 2.77 3.53 3.04V20h1.5v-2.51c1.86-.26 3.32-1.28 3.32-3.06 0-2.21-1.91-2.94-4.02-3.29z"/></svg>',
        gem: '<svg viewBox="0 0 24 24"><path d="M12 2l-5.5 9h11z"/><path d="M17.5 9l-5.5 9-5.5-9h11z" opacity=".3"/><path d="M6.5 9H2l10 13L22 9h-4.5L12 18 6.5 9z" opacity=".6"/></svg>',
        star: '<svg viewBox="0 0 24 24"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>',
        trophy: '<svg viewBox="0 0 24 24"><path d="M19 5h-2V3H7v2H5c-1.1 0-2 .9-2 2v1c0 2.55 1.92 4.63 4.39 4.94.63 1.5 1.98 2.63 3.61 2.96V19H7v2h10v-2h-4v-3.1c1.63-.33 2.98-1.46 3.61-2.96C19.08 12.63 21 10.55 21 8V7c0-1.1-.9-2-2-2zM5 8V7h2v3.82C5.84 10.4 5 9.3 5 8zm14 0c0 1.3-.84 2.4-2 2.82V7h2v1z"/></svg>',
        store: '<svg viewBox="0 0 24 24"><path d="M20 4H4v2h16V4zm1 10v-2l-1-5H4l-1 5v2h1v6h10v-6h4v6h2v-6h1zm-9 4H6v-4h6v4z"/></svg>',
        mouse: '<svg viewBox="0 0 24 24"><path d="M13 9h-2V7h2v2zm0 4h-2v-2h2v2zm0 4h-2v-2h2v2zm-1-13C7.58 4 4 7.58 4 12s3.58 8 8 8 8-3.58 8-8-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6z"/></svg>',
        'mouse-pointer': '<svg viewBox="0 0 24 24"><path d="M13.64 21.97c.49.35 1.18.25 1.54-.23L21 13.5V3h-9.5L2.23 8.82c-.48.36-.58 1.05-.23 1.54l3.5 4.9c.35.49 1.05.58 1.54.23l2.88-2.05 3.02 4.26-2.05 2.88c-.35.49-.25 1.18.23 1.54l4.9 3.5z"/></svg>',
        flame: '<svg viewBox="0 0 24 24"><path d="M13.5.67s.74 2.65.74 4.8c0 2.06-1.35 3.73-3.41 3.73-2.07 0-3.63-1.67-3.63-3.73l.03-.36C5.21 7.51 4 10.62 4 14c0 4.42 3.58 8 8 8s8-3.58 8-8C20 8.61 17.41 3.8 13.5.67zM11.71 19c-1.78 0-3.22-1.4-3.22-3.14 0-1.62 1.05-2.76 2.81-3.12 1.77-.36 3.6-1.21 4.62-2.58.39 1.29.59 2.65.59 4.04 0 2.65-2.15 4.8-4.8 4.8z"/></svg>',
        briefcase: '<svg viewBox="0 0 24 24"><path d="M20 6h-4V4c0-1.11-.89-2-2-2h-4c-1.11 0-2 .89-2 2v2H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-6 0h-4V4h4v2z"/></svg>',
        building: '<svg viewBox="0 0 24 24"><path d="M12 7V3H2v18h20V7H12zM6 19H4v-2h2v2zm0-4H4v-2h2v2zm0-4H4V9h2v2zm0-4H4V5h2v2zm4 12H8v-2h2v2zm0-4H8v-2h2v2zm0-4H8V9h2v2zm0-4H8V5h2v2zm10 12h-8v-2h2v-2h-2v-2h2v-2h-2V9h8v10z"/></svg>',
        laptop: '<svg viewBox="0 0 24 24"><path d="M20 18c1.1 0 1.99-.9 1.99-2L22 5c0-1.1-.9-2-2-2H4c-1.1 0-2 .9-2 2v11c0 1.1.9 2 2 2H0c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2h-4zM4 5h16v11H4V5z"/></svg>',
        zap: '<svg viewBox="0 0 24 24"><path d="M11 21h-1l1-7H7.5c-.58 0-.57-.32-.38-.66.19-.34.05-.08.07-.12C8.48 10.94 10.42 7.54 13 3h1l-1 7h3.5c.49 0 .56.33.47.51l-.07.15C12.96 17.55 11 21 11 21z"/></svg>',
        calculator: '<svg viewBox="0 0 24 24"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 2h2v2h-2V5zm0 4h2v2h-2V9zm0 4h2v2h-2v-2zM5 15h4v4H5v-4zm6 0h2v2h-2v-2zm0-4h2v2h-2V9zm0-4h2v2h-2V5zm6 8h2v2h-2v-2zm0-4h2v2h-2V9zm0-4h2v2h-2V5z"/></svg>',
        scale: '<svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-5-9h10v2H7z"/></svg>',
        crown: '<svg viewBox="0 0 24 24"><path d="M5 16L3 5l5.5 5L12 4l3.5 6L21 5l-2 11H5zm14 3c0 .6-.4 1-1 1H6c-.6 0-1-.4-1-1v-1h14v1z"/></svg>',
        coffee: '<svg viewBox="0 0 24 24"><path d="M18.5 3H6c-1.1 0-2 .9-2 2v5.71c0 3.83 2.95 7.18 6.78 7.29 3.96.12 7.22-3.06 7.22-7v-1h.5c1.93 0 3.5-1.57 3.5-3.5S20.43 3 18.5 3zM16 8.99c0 2.2-1.8 3.99-3.99 3.99-2.2 0-4-1.8-4-4V5h8v3.99zm2.5-1.99h-1.5v-2h1.5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5zM2 19h20v2H2z"/></svg>',
        utensils: '<svg viewBox="0 0 24 24"><path d="M11 9H9V2H7v7H5V2H3v7c0 2.12 1.66 3.84 3.75 3.97V22h2.5v-9.03C11.34 12.84 13 11.12 13 9V2h-2v7zm5-3v8h2.5v8H21V2c-2.76 0-5 2.24-5 4z"/></svg>',
        'shopping-bag': '<svg viewBox="0 0 24 24"><path d="M19 6h-2c0-2.76-2.24-5-5-5S7 3.24 7 6H5c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm-7-3c1.66 0 3 1.34 3 3H9c0-1.66 1.34-3 3-3zm0 10c-2.76 0-5-2.24-5-5h2c0 1.66 1.34 3 3 3s3-1.34 3-3h2c0 2.76-2.24 5-5 5z"/></svg>',
        hotel: '<svg viewBox="0 0 24 24"><path d="M7 13c1.66 0 3-1.34 3-3S8.66 7 7 7s-3 1.34-3 3 1.34 3 3 3zm12-6h-8v7H3V5H1v15h2v-3h18v3h2v-9c0-2.21-1.79-4-4-4z"/></svg>',
        'shopping-cart': '<svg viewBox="0 0 24 24"><path d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h7.45c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.08-.14.12-.31.12-.48 0-.55-.45-1-1-1H5.21l-.94-2H1zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2z"/></svg>',
        smartphone: '<svg viewBox="0 0 24 24"><path d="M17 1.01L7 1c-1.1 0-2 .9-2 2v18c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V3c0-1.1-.9-1.99-2-1.99zM17 19H7V5h10v14z"/></svg>',
        cloud: '<svg viewBox="0 0 24 24"><path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96z"/></svg>',
        pickaxe: '<svg viewBox="0 0 24 24"><path d="M14.5 13.5L3 2 2 3l11.5 11.5L9 19l1 1 4.5-4.5L19 22l1-1-4.5-4.5 4.5-4.5-1-1-4.5 4.5z"/></svg>',
        bot: '<svg viewBox="0 0 24 24"><path d="M12 2a2 2 0 0 1 2 2c0 .74-.4 1.38-1 1.72v.78h3c1.1 0 2 .9 2 2v10c0 1.1-.9 2-2 2H7c-1.1 0-2-.9-2-2V8.5c0-1.1.9-2 2-2h3v-.78c-.6-.34-1-.98-1-1.72a2 2 0 0 1 2-2M7 8.5v10h10v-10H7z"/><circle cx="9" cy="12" r="1"/><circle cx="15" cy="12" r="1"/></svg>',
        rocket: '<svg viewBox="0 0 24 24"><path d="M12 2.5s-4 4.5-4 10.5c0 2.5 1.5 4 4 4s4-1.5 4-4c0-6-4-10.5-4-10.5zM9 18c0 1.66 1.34 3 3 3s3-1.34 3-3v-1H9v1z"/></svg>',
        user: '<svg viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>',
        wallet: '<svg viewBox="0 0 24 24"><path d="M21 18v1c0 1.1-.9 2-2 2H5c-1.11 0-2-.9-2-2V5c0-1.1.89-2 2-2h14c1.1 0 2 .9 2 2v1h-9c-1.11 0-2 .9-2 2v8c0 1.1.89 2 2 2h9zm-9-2h10V8H12v8zm4-2.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"/></svg>',
        spin: '<svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v6h-2zm0 8h2v2h-2z"/></svg>',
        globe: '<svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/></svg>',
        settings: '<svg viewBox="0 0 24 24"><path d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L5.09 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/></svg>',
        lock: '<svg viewBox="0 0 24 24"><path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z"/></svg>',
        wait: '<svg viewBox="0 0 24 24"><path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"/></svg>'
    };

    const COST_MULT   = 1.15;
    const EARN_MULT   = 1.12;
    const ENERGY_COST = 1;
    const ENERGY_REGEN= 1;
    const COMBO_TIME  = 1.5;
    const MAX_COMBO   = 50;
    const COMBO_GAIN  = 0.08;
    const COMBO_DECAY = 0.5;
    const COLLECT_DUR = 10;

    function defaultState() {
        let cards = {};
        CARDS.forEach(c => { cards[c.id] = {level:0}; });
        return {
            score:0, level:1, xp:0, xpToNextLevel:100,
            clickPower:1, energy:1000, maxEnergy:1000,
            lastUpdate:Date.now(), collectTimer:0, cards:cards,
            playerName: 'Oyuncu', avatar: 'user',
            totalClicks: 0, totalEarned: 0, maxCombo: 1,
            spinCount: 3, lastSpinReset: Date.now(),
            unlockedAchievements: []
        };
    }

    let gs = defaultState();
    let combo=1, comboTimer=0, lastLoop=Date.now();
    let activeCat = 'profesyoneller';
    let activeSheet = null;
    let isSpinning = false;

    const KEY = 'tapGameSave_v13';
    function save() {
        gs.lastUpdate = Date.now();
        let d = JSON.stringify(gs);
        try{localStorage.setItem(KEY,d);}catch(e){}
    }
    function load() {
        let s=null;
        try{s=localStorage.getItem(KEY);}catch(e){}
        if(s){
            try{
                let ld=JSON.parse(s);
                CARDS.forEach(c=>{ if(!ld.cards[c.id]) ld.cards[c.id]={level:0}; });
                if(!ld.playerName) ld.playerName = 'Oyuncu';
                if(!ld.avatar) ld.avatar = 'user';
                if(!ld.totalClicks) ld.totalClicks = 0;
                if(!ld.totalEarned) ld.totalEarned = 0;
                if(!ld.maxCombo) ld.maxCombo = 1;
                if(!ld.spinCount) ld.spinCount = 3;
                if(!ld.lastSpinReset) ld.lastSpinReset = Date.now();
                if(!ld.unlockedAchievements) ld.unlockedAchievements = [];
                gs=ld;
            }catch(e){}
        }
    }

    function cardCost(c){ return Math.floor(c.baseCost * Math.pow(COST_MULT, gs.cards[c.id].level)); }
    function cardEarn(c){
        let l=gs.cards[c.id].level;
        if(l===0) return 0;
        return Math.floor(c.baseEarn * Math.pow(EARN_MULT, l-1) * l);
    }
    function cardEarnNext(c){
        let l=gs.cards[c.id].level;
        return Math.floor(c.baseEarn * Math.pow(EARN_MULT, l) * (l+1));
    }
    function totalEarn(){
        let t=0;
        CARDS.forEach(c=>{ if(!c.isUpgrade) t+=cardEarn(c); });
        return t;
    }
    function isOpen(c){ return !c.unlock || gs.cards[c.unlock.card].level >= c.unlock.level; }
    function cpCost(){ return Math.floor(50*Math.pow(1.5, gs.clickPower-1)); }

    function offlineCalc(){
        let now=Date.now();
        let diff=Math.floor((now-gs.lastUpdate)/1000);
        if(gs.collectTimer>0 && diff>0) gs.collectTimer=Math.max(0, gs.collectTimer-diff);
        
        let spinDiff = now - gs.lastSpinReset;
        if(spinDiff >= 24*3600*1000) {
            gs.spinCount = 3;
            gs.lastSpinReset = now;
        }
        
        gs.lastUpdate=now;
    }

    function checkLvl(){
        if(gs.xp >= gs.xpToNextLevel){
            gs.level++;
            gs.xp=0;
            gs.xpToNextLevel=Math.floor(gs.xpToNextLevel*1.6);
            gs.maxEnergy+=50;
            gs.energy=gs.maxEnergy;
            let bonus=gs.level*100;
            gs.score+=bonus;
            popup('coin','Level '+gs.level+'!','+'+bonus.toLocaleString()+' coin bonus & enerji doldu!');
            checkAchievements();
        }
    }

    function checkAchievements() {
        ACHIEVEMENTS.forEach(ach => {
            if(!gs.unlockedAchievements.includes(ach.id) && ach.check(gs)) {
                gs.unlockedAchievements.push(ach.id);
                popup('trophy', 'Başarım Açıldı!', ach.name + ': ' + ach.desc);
            }
        });
    }

    function pendingR(){ return Math.floor((totalEarn()/3600)*COLLECT_DUR); }

    function collect(){
        if(gs.collectTimer>0) return;
        let r=pendingR();
        if(r<=0) return;
        gs.score+=r;
        gs.totalEarned+=r;
        gs.collectTimer=COLLECT_DUR;
        popup('coin','Toplandı!','+'+r.toLocaleString()+' coin kazandın!');
        checkAchievements();
        save(); renderUI();
    }

    function buyCard(c){
        if(c.isUpgrade){buyCP();return;}
        if(!isOpen(c)) return;
        let cost=cardCost(c);
        if(gs.score<cost) return;
        gs.score-=cost;
        gs.cards[c.id].level++;
        checkAchievements();
        save(); renderUI();
    }

    function buyCP(){
        let cost=cpCost();
        if(gs.score<cost) return;
        gs.score-=cost;
        gs.clickPower++;
        save(); renderUI();
    }

    let lastTap=0;
    function handleTap(e){
        let now=Date.now();
        if(now-lastTap<100) return;
        lastTap=now;
        e.preventDefault();
        if(gs.energy<ENERGY_COST) return;

        comboTimer=COMBO_TIME;
        if(combo<MAX_COMBO) {
            combo += COMBO_GAIN;
        }
        if(combo > gs.maxCombo) gs.maxCombo = combo;

        let gain=Math.floor(gs.clickPower*combo);
        gs.score+=gain;
        gs.totalEarned+=gain;
        gs.xp+=1;
        gs.energy-=ENERGY_COST;
        gs.totalClicks++;
        checkLvl();
        checkAchievements();

        let cx,cy;
        if(e.touches&&e.touches.length){cx=e.touches[0].clientX;cy=e.touches[0].clientY;}
        else if(e.changedTouches&&e.changedTouches.length){cx=e.changedTouches[0].clientX;cy=e.changedTouches[0].clientY;}
        else{cx=e.clientX;cy=e.clientY;}
        ftxt(cx,cy,'+'+gain);
        renderUI();
    }

    let coinEl=document.getElementById('coin-container');
    coinEl.addEventListener('touchstart',handleTap,{passive:false});
    coinEl.addEventListener('click',handleTap);

    function ftxt(x,y,t){
        let el=document.createElement('div');
        el.className='floating-text';
        el.innerText=t;
        el.style.left=(x-12)+'px';
        el.style.top=(y-35)+'px';
        document.body.appendChild(el);
        setTimeout(()=>el.remove(),800);
    }

    function popup(iconKey,title,desc){
        let iconSvg = ICONS[iconKey] || ICONS['coin'];
        let p=document.createElement('div');
        p.className='popup-overlay';
        p.innerHTML='<div class="popup-box"><div class="pop-icon">'+iconSvg+'</div><h2>'+title+'</h2><p>'+desc+'</p><button onclick="this.closest(\'.popup-overlay\').remove()">Devam →</button></div>';
        document.body.appendChild(p);
    }

    function loop(){
        let now=Date.now();
        let dt=(now-lastLoop)/1000;
        lastLoop=now;

        if(gs.energy<gs.maxEnergy) gs.energy=Math.min(gs.maxEnergy, gs.energy+ENERGY_REGEN*dt);
        if(gs.collectTimer>0){ gs.collectTimer-=dt; if(gs.collectTimer<0) gs.collectTimer=0; }
        
        if(comboTimer>0){ 
            comboTimer-=dt; 
            if(comboTimer<=0){
                comboTimer=0;
                combo = Math.max(1, combo * COMBO_DECAY);
            } 
        }

        updateSpinTimer();
        renderUI();
    }

    function fmtTime(s){
        s=Math.max(0,Math.ceil(s));
        let h=Math.floor(s/3600), m=Math.floor((s%3600)/60), sec=s%60;
        return h+':'+String(m).padStart(2,'0')+':'+String(sec).padStart(2,'0');
    }

    function renderTabs(){
        let el=document.getElementById('cat-tabs');
        el.innerHTML='';
        CATEGORIES.forEach(cat=>{
            let btn=document.createElement('div');
            btn.className='cat-tab'+(activeCat===cat.id?' active':'');
            btn.innerHTML='<span class="tab-icon">'+ICONS[cat.icon]+'</span>'+cat.name;
            btn.onclick=()=>{ activeCat=cat.id; renderTabs(); renderCards(); };
            el.appendChild(btn);
        });
    }

    function renderCards(){
        let scroll=document.getElementById('cards-scroll');
        scroll.innerHTML='';

        CARDS.filter(c=>c.cat===activeCat).forEach(card=>{
            let lvl=gs.cards[card.id].level;
            let opened=isOpen(card);
            let cost=cardCost(card);
            let canBuy=opened && gs.score>=cost;
            let el=document.createElement('div');

            if(!opened){
                el.className='card locked';
                let req=CARDS.find(c=>c.id===card.unlock.card);
                el.innerHTML=
                    '<div class="card-top">'+
                        '<div class="card-icon locked-icon">'+ICONS['lock']+'</div>'+
                        '<span class="card-name">'+card.name+'</span>'+
                        '<span class="card-earn" style="color:#555;font-size:0.65rem">'+req.name+' Lv.'+card.unlock.level+'</span>'+
                    '</div>'+
                    '<div class="card-bottom">'+
                        '<span class="locked-icon" style="width:30px;height:30px;">'+ICONS['lock']+'</span>'+
                    '</div>';
                scroll.appendChild(el);
                return;
            }

            if(card.isUpgrade){
                el.className='card'+(canBuy?' can-buy':' cant-afford');
                el.onclick=()=>buyCP();
                el.innerHTML=
                    '<div class="card-top">'+
                        '<div class="card-icon">'+ICONS[card.icon]+'</div>'+
                        '<span class="card-name">'+card.name+'</span>'+
                        '<span class="card-earn">Şu an: '+gs.clickPower+'x</span>'+
                    '</div>'+
                    '<div class="card-bottom">'+
                        '<span class="card-price"><span class="icon-inline">'+ICONS['coin']+'</span>'+cost.toLocaleString()+'</span>'+
                        '<span class="card-lvl">Lv.'+lvl+'</span>'+
                    '</div>';
                scroll.appendChild(el);
                return;
            }

            el.className='card'+(canBuy?' can-buy':' cant-afford');
            el.onclick=()=>buyCard(card);

            let earnStr;
            if(lvl===0) earnStr='+'+cardEarnNext(card).toLocaleString()+'/h';
            else earnStr=cardEarn(card).toLocaleString()+'/h';

            el.innerHTML=
                '<div class="card-top">'+
                    '<div class="card-icon">'+ICONS[card.icon]+'</div>'+
                    '<span class="card-name">'+card.name+'</span>'+
                    '<span class="card-earn">'+earnStr+'</span>'+
                '</div>'+
                '<div class="card-bottom">'+
                    '<span class="card-price"><span class="icon-inline">'+ICONS['coin']+'</span>'+cost.toLocaleString()+'</span>'+
                    '<span class="card-lvl">Lv.'+lvl+'</span>'+
                '</div>';
            scroll.appendChild(el);
        });
    }

    function renderProfile() {
        document.getElementById('avatar-display').innerHTML = ICONS[gs.avatar] || ICONS['user'];
        document.getElementById('profile-name').textContent = gs.playerName;
        document.getElementById('stat-coins').textContent = Math.floor(gs.totalEarned).toLocaleString();
        document.getElementById('stat-level').textContent = gs.level;
        document.getElementById('stat-clicks').textContent = gs.totalClicks.toLocaleString();
        
        let cardCount = 0;
        CARDS.forEach(c => { if(!c.isUpgrade && gs.cards[c.id].level > 0) cardCount++; });
        document.getElementById('stat-cards').textContent = cardCount;

        renderAchievements();
    }

    function renderAchievements() {
        let grid = document.getElementById('achievements-grid');
        grid.innerHTML = '';
        ACHIEVEMENTS.forEach(ach => {
            let unlocked = gs.unlockedAchievements.includes(ach.id);
            let div = document.createElement('div');
            div.className = 'achievement ' + (unlocked ? 'unlocked' : 'locked');
            div.innerHTML = `
                <div class="achievement-icon">${ICONS[ach.icon]}</div>
                <div class="achievement-name">${ach.name}</div>
                <div class="achievement-desc">${ach.desc}</div>
            `;
            grid.appendChild(div);
        });
    }

    function updateSpinTimer() {
        let now = Date.now();
        let diff = now - gs.lastSpinReset;
        let remaining = 24*3600*1000 - diff;
        
        if(remaining <= 0) {
            gs.spinCount = 3;
            gs.lastSpinReset = now;
            save();
        }
        
        document.getElementById('spin-count').textContent = gs.spinCount;
        
        if(gs.spinCount === 0) {
            let hours = Math.floor(remaining / 3600000);
            let mins = Math.floor((remaining % 3600000) / 60000);
            document.getElementById('spin-timer-text').textContent = 
                `Yeni spin: ${hours}s ${mins}d`;
        } else {
            document.getElementById('spin-timer-text').textContent = '';
        }
    }

    window.spinWheel = function() {
        if(isSpinning || gs.spinCount <= 0) return;
        
        isSpinning = true;
        gs.spinCount--;
        
        let btn = document.getElementById('spin-btn');
        btn.disabled = true;
        btn.textContent = 'ÇEVİRİLİYOR...';
        
        let prizeIndex = Math.floor(Math.random() * WHEEL_PRIZES.length);
        let prize = WHEEL_PRIZES[prizeIndex];
        let rotation = 360 * 5 + (360 / WHEEL_PRIZES.length) * prizeIndex;
        
        let wheel = document.getElementById('wheel');
        wheel.style.transform = `rotate(${rotation}deg)`;
        
        setTimeout(() => {
            gs.score += prize.value;
            gs.totalEarned += prize.value;
            popup('coin', 'Kazandın!', `+${prize.value.toLocaleString()} Coin!`);
            checkAchievements();
            save();
            
            btn.disabled = false;
            btn.textContent = 'ÇEVİR!';
            isSpinning = false;
            wheel.style.transform = 'rotate(0deg)';
            renderUI();
        }, 4000);
    };

    window.editName = function() {
        let newName = prompt('Yeni isminizi girin:', gs.playerName);
        if(newName && newName.trim()) {
            gs.playerName = newName.trim();
            save();
            renderProfile();
        }
    };

    window.openAvatarSelector = function() {
        let html = '<h3 style="margin-bottom: 15px;">Avatar Seç</h3><div class="avatar-grid">';
        AVATARS.forEach(av => {
            html += `<div class="avatar-option${av===gs.avatar?' selected':''}" onclick="selectAvatar('${av}')">${ICONS[av]}</div>`;
        });
        html += '</div>';
        
        let p = document.createElement('div');
        p.className = 'popup-overlay';
        p.innerHTML = `<div class="popup-box">${html}<button onclick="this.closest('.popup-overlay').remove()">Tamam</button></div>`;
        document.body.appendChild(p);
    };

    window.selectAvatar = function(avatar) {
        gs.avatar = avatar;
        save();
        document.getElementById('avatar-display').innerHTML = ICONS[avatar];
        document.querySelectorAll('.avatar-option').forEach(el => {
            el.classList.remove('selected');
        });
        event.target.closest('.avatar-option').classList.add('selected');
    };

    function renderUI(){
        document.getElementById('score').innerText=Math.floor(gs.score).toLocaleString();

        let eh=totalEarn();
        document.getElementById('hourly-income').innerText=eh.toLocaleString();
        document.getElementById('pending-income').innerText=pendingR().toLocaleString();

        document.getElementById('level-val').innerText=gs.level;
        document.getElementById('xp-text').innerText=Math.floor(gs.xp)+' / '+gs.xpToNextLevel+' XP';
        document.getElementById('xp-fill').style.width=(gs.xp/gs.xpToNextLevel*100)+'%';

        document.getElementById('energy-text').innerText=Math.floor(gs.energy)+' / '+gs.maxEnergy;
        document.getElementById('energy-fill').style.width=(gs.energy/gs.maxEnergy*100)+'%';

        let cp=comboTimer>0?(comboTimer/COMBO_TIME*100):0;
        document.getElementById('combo-fill').style.width=cp+'%';
        document.getElementById('combo-text').style.opacity=(combo>1)?'1':'0';
        document.getElementById('combo-text').innerHTML='<span class="icon-inline" style="width:16px;height:16px;">'+ICONS['flame']+'</span>COMBO X'+Math.floor(combo);

        let cBtn=document.getElementById('collect-btn');
        let cAmount=document.getElementById('collect-amount');
        let cLabel=document.getElementById('collect-label');
        let pend=pendingR();
        
        if(gs.collectTimer>0){
            cBtn.className='collect-btn waiting';
            cAmount.innerHTML='<span class="icon-inline" style="width:24px;height:24px;">'+ICONS['wait']+'</span>';
            cLabel.innerText=fmtTime(gs.collectTimer);
        } else if(pend>0){
            cBtn.className='collect-btn visible has-coins';
            cAmount.innerHTML='<span class="icon-inline" style="width:24px;height:24px;">'+ICONS['coin']+'</span>';
            cLabel.innerText='TOPLA';
        } else {
            cBtn.className='collect-btn';
            cAmount.innerText='';
            cLabel.innerText='';
        }

        coinEl.className=gs.energy<ENERGY_COST?'coin-disabled':'';

        let ownedCount = 0;
        CARDS.forEach(c=>{ if(!c.isUpgrade && gs.cards[c.id].level>0) ownedCount++; });
        document.getElementById('kartlar-badge').innerText = ownedCount;

        if(activeSheet === 'kartlar') renderCards();
        if(activeSheet === 'profil') renderProfile();
    }

    window.closeAllSheets = function(){
        activeSheet = null;
        document.getElementById('sheet-overlay').classList.remove('open');
        document.querySelectorAll('.sheet').forEach(s => s.classList.remove('open'));
    }

    function openSheet(sheetName){
        closeAllSheets();
        activeSheet = sheetName;
        document.getElementById('sheet-overlay').classList.add('open');
        document.getElementById('sheet-'+sheetName).classList.add('open');
        
        if(sheetName === 'kartlar'){
            renderTabs();
            renderCards();
        } else if(sheetName === 'profil') {
            renderProfile();
        }
    }

    document.getElementById('btn-kartlar').addEventListener('click', () => openSheet('kartlar'));
    document.getElementById('btn-spin').addEventListener('click', () => openSheet('spin'));
    document.getElementById('btn-profil').addEventListener('click', () => openSheet('profil'));
    document.getElementById('btn-cuzdan').addEventListener('click', () => openSheet('cuzdan'));
    document.getElementById('btn-roadmap').addEventListener('click', () => openSheet('roadmap'));
    
    document.getElementById('sheet-overlay').addEventListener('click', closeAllSheets);

    load();
    offlineCalc();
    lastLoop=Date.now();
    renderUI();
    setInterval(loop,500);
    setInterval(save,3000);

    document.getElementById('collect-btn').addEventListener('click', collect);

})();
</script>

<!-- Yan Menü -->
<div class="drawer-overlay" id="drawer-overlay"></div>
<div class="drawer" id="drawer">
    <div class="drawer-header">
        <h2>☰ Menü</h2>
        <p>GO Coin Game</p>
    </div>
    <div class="drawer-content">
        <div class="drawer-item" onclick="closeDrawer(); alert('Profil özelliği yakında!')">
            <span class="drawer-item-icon">
                <svg viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
            </span>
            <div class="drawer-item-text">
                <div class="drawer-item-title">Profilim</div>
                <div class="drawer-item-desc">Hesap bilgileri</div>
            </div>
        </div>

        <div class="drawer-item" onclick="closeDrawer(); alert('Ayarlar özelliği yakında!')">
            <span class="drawer-item-icon">
                <svg viewBox="0 0 24 24"><path d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L5.09 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/></svg>
            </span>
            <div class="drawer-item-text">
                <div class="drawer-item-title">Ayarlar</div>
                <div class="drawer-item-desc">Oyun tercihleri</div>
            </div>
        </div>

        <div class="drawer-item" onclick="closeDrawer(); alert('İstatistikler özelliği yakında!')">
            <span class="drawer-item-icon">
                <svg viewBox="0 0 24 24"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/></svg>
            </span>
            <div class="drawer-item-text">
                <div class="drawer-item-title">İstatistikler</div>
                <div class="drawer-item-desc">Detaylı veriler</div>
            </div>
        </div>

        <div class="drawer-divider"></div>

        <div class="drawer-item" onclick="closeDrawer(); alert('Liderlik tablosu yakında!')">
            <span class="drawer-item-icon">
                <svg viewBox="0 0 24 24"><path d="M19 5h-2V3H7v2H5c-1.1 0-2 .9-2 2v1c0 2.55 1.92 4.63 4.39 4.94.63 1.5 1.98 2.63 3.61 2.96V19H7v2h10v-2h-4v-3.1c1.63-.33 2.98-1.46 3.61-2.96C19.08 12.63 21 10.55 21 8V7c0-1.1-.9-2-2-2zM5 8V7h2v3.82C5.84 10.4 5 9.3 5 8zm14 0c0 1.3-.84 2.4-2 2.82V7h2v1z"/></svg>
            </span>
            <div class="drawer-item-text">
                <div class="drawer-item-title">Liderlik Tablosu</div>
                <div class="drawer-item-desc">En iyi oyuncular</div>
            </div>
        </div>

        <div class="drawer-item" onclick="closeDrawer(); alert('Arkadaşlar özelliği yakında!')">
            <span class="drawer-item-icon">
                <svg viewBox="0 0 24 24"><path d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"/></svg>
            </span>
            <div class="drawer-item-text">
                <div class="drawer-item-title">Arkadaşlar</div>
                <div class="drawer-item-desc">Davet et & kazan</div>
            </div>
        </div>

        <div class="drawer-divider"></div>

        <div class="drawer-item" onclick="closeDrawer(); alert('Yardım sayfası yakında!')">
            <span class="drawer-item-icon">
                <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z"/></svg>
            </span>
            <div class="drawer-item-text">
                <div class="drawer-item-title">Yardım</div>
                <div class="drawer-item-desc">Nasıl oynanır?</div>
            </div>
        </div>

        <div class="drawer-item" onclick="closeDrawer(); alert('GO Coin v1.0.0')">
            <span class="drawer-item-icon">
                <svg viewBox="0 0 24 24"><path d="M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"/></svg>
            </span>
            <div class="drawer-item-text">
                <div class="drawer-item-title">Hakkında</div>
                <div class="drawer-item-desc">Versiyon 1.0.0</div>
            </div>
        </div>
    </div>
</div>

<script>
// Global fonksiyonlar
function closeDrawer() {
    document.getElementById('drawer-overlay').classList.remove('open');
    document.getElementById('drawer').classList.remove('open');
}

window.addEventListener('DOMContentLoaded', function() {
    document.getElementById('menu-btn').addEventListener('click', function(e) {
        e.stopPropagation();
        document.getElementById('drawer-overlay').classList.add('open');
        document.getElementById('drawer').classList.add('open');
    });

    document.getElementById('drawer-overlay').addEventListener('click', closeDrawer);
});
</script>

</body>
</html>
